version: '3.7'

services:
  vott:
    build:
      context: .
      args:
        - BUILDTIME_CORTEXIA_VERSION=${CORTEXIA_VERSION}
    env_file : .env
    image: cortexia/vott:${DOCKER_TAG}
    container_name: vott
    deploy:
      labels:
        - "traefik.enable=true"
        - "traefik.docker.network=${TRAEFIK_PUBLIC_NETWORK}"
        - "traefik.http.routers.${STACK_NAME}.entrypoints=websecure"
        - "traefik.http.routers.${STACK_NAME}.tls.certresolver=cloudflare"
        - "traefik.http.routers.${STACK_NAME}.rule=Host(`${SUBDOMAIN}.${DOMAIN}`)"
        - "traefik.http.services.${STACK_NAME}.loadbalancer.server.port=5000"

